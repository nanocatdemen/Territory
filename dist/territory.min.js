CubeCoordinateSet=function(e){var t=function(){var e={},t={elements:e};t.get=function(e){if(e.x+e.y+e.z!=0)throw"Error: invalid cube coordinate";return t.elements[e.x.toString()+","+e.y.toString()+","+e.z.toString()]},t.set=function(e,n){if(e.x+e.y+e.z!=0)throw"Error: invalid cube coordinate";t.elements[e.x.toString()+","+e.y.toString()+","+e.z.toString()]=n};return t};return t}(jQuery);var Hexagon=fabric.util.createClass(fabric.Polygon,{type:"hexagon",initialize:function(e,t,n){n||(n={});for(var r=[],a=0;6>a;a++){var o=60*a,i=Math.PI/180*o,c={x:e.x+t*Math.cos(i),y:e.y+t*Math.sin(i)};r.push(c)}this.callSuper("initialize",r,n),this.set("center",e),this.set("edgeSize",t)},toObject:function(){return fabric.util.object.extend(this.callSuper("toObject"),{center:this.get("center"),size:this.get("edgeSize")})}});Grid=function(e){var t=function(e,t){var n=t.canvas,r=t.hexagonSize,a=t.center,o=CubeCoordinateSet();for(hexagonCoorKey in e){var i=e[hexagonCoorKey][0],c=e[hexagonCoorKey][1],s=e[hexagonCoorKey][2];if(i+c+s==0){var g={x:a.x+1.5*r*i,y:a.y+Math.sqrt(3)/2*r*s-Math.sqrt(3)/2*r*c},h=new Hexagon(g,50,{fill:"#D3E5F0",stroke:"#1F8ACF",selectable:!1});h.perPixelTargetFind=!0,o.set({x:i,y:c,z:s},h)}}var l={canvas:n,hexagons:o};return l.draw=function(){for(hexagonKey in l.hexagons.elements)l.canvas.add(l.hexagons.elements[hexagonKey])},l};return t}(jQuery);var canvas=new fabric.Canvas("c",{width:800,height:800});canvas.selection=!1;var center={x:400,y:400},hexagonsCoors=[[0,0,0],[0,1,-1],[0,-1,1],[1,0,-1],[-1,0,1],[1,-1,0],[-1,1,0]],g=Grid(hexagonsCoors,{canvas:canvas,hexagonSize:50,center:center});g.draw(),canvas.on("mouse:up",function(e){if(e.target){var t=e.target;t.clicked?(t.clicked=!1,t.setColor("#D3E5F0")):(t.clicked=!0,t.setColor("#FF968E"))}this.renderAll()});